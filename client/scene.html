<template name="scene">
	<!-- camera/scene settings -->
	<viewpoint position="8.19 12.33 19.5"
		orientation="-0.834 0.55 0 0.65"></viewpoint>

	<!-- turn navigation on and off reactively -->
  <navigationinfo type="{{#if buildMode}}none{{else}}turntable{{/if}}"
  headlight="false"></navigationinfo>
	
	<!-- lights -->
	<pointLight location="0 40 0" intensity="0.3"></pointLight>
	<pointLight location="-30 10 -20" intensity="0.7"></pointLight>
	<directionalLight direction="-1 -1 -0.7" color="#ffe"
		intensity="0.8" shadowIntensity="0.3"
		shadowFilterSize="5"></directionalLight>
	
	<!-- ground -->
	<transform rotation="-1.5707963267948966 0 0 1.5707963267948966">
  	<shape>
  		<appearance>
  			<!-- XXX could be improved to a grass texture -->
	  		<material diffuseColor="#4A9"></material>
	  	</appearance>
	  	<plane size="20 20"></plane>
	  </shape>
	</transform>

	<!-- boxes -->
	{{#each boxes}}
		<!-- scale 0.5 because default size of box is 2 units on a side -->
		<transform translation="{{x}} {{y}} {{z}}" scale="0.5 0.5 0.5">
	    <shape id="{{_id}}">
	      <appearance>
	      	<!-- could be improved to have texture and not just color -->
	        <material diffuseColor="{{color}}" ambientIntensity="0.1"
	        	shininess="0"></material>
	      </appearance>
	      <box></box>
	    </shape>
	  </transform>
  {{/each}}
</template>

<template name="controls">
	<!-- floating UI box -->
	<div class="controls">
		<h1>
			<a href="#/"><span class="glyphicon glyphicon-home"></span></a>
			Meteor Blocks
		</h1>
		<p class="subtitle">Made with X3DOM</p>

		{{#unless frozen}}
			<h2>Mode</h2>
			<p>
				<button class="view-mode btn btn-sm
					{{#if buildMode}}btn-default{{else}}btn-primary{{/if}}">
					View</button>
				<button class="build-mode btn btn-sm
					{{#if buildMode}}btn-primary{{else}}btn-default{{/if}}">
					Build</button>
			</p>
		{{/unless}}

		{{#if buildMode}}
			<h2>Build Controls</h2>
			<p>
				Click to place a block <br />
				Right-click to delete one
			</p>
			<button class="clear-boxes btn btn-sm btn-default">
				Clear all blocks</button>

			<div class="color-picker">
				<h2>Color picker</h2>
				{{#each colors}}
					<div class="swatch{{#if activeColor}} active{{/if}}" style="background-color: {{code}}">
					</div>
				{{/each}}
			</div>
		{{else}}
			<h2>Camera Controls</h2>
			<p>
				Drag to rotate view <br />
				Scroll to zoom
			</p>
		{{/if}}

		
		{{#if frozen}}
			<h2>Make Your Own</h2>
			<p class="explanation">
				This scene has been frozen.  Clone yourself a new version to edit it!
			</p>
			<button class="clone btn btn-sm btn-default">Clone</button>
			<h2>Share</h2>
			<p><img src="{{screenshot}}" class="screenshot" /></p>
			<button class='btn btn-primary btn-sm facebook'>Share on Facebook</button>
		{{else}}
			<h2>Collaborate</h2>
			<p>Anyone can collaborate on this scene if they go to this page.</p>
			<p>Click freeze to save this version and publish it to the front page.</p>
			<button class="freeze btn btn-sm btn-default">Freeze</button>
			<button class="clone btn btn-sm btn-default">Clone</button>
		{{/if}}

		<div class="github-link">
			<a href="http://git.io/meteor3d">See the code on GitHub</a>
		</div>
	</div>
</template>